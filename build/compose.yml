name: habitat-node
services:
  habitat_node:
    volumes:
        - ${TOPDIR}/core:${DOCKER_WORKDIR}/core
        - ${TOPDIR}/cmd:${DOCKER_WORKDIR}/cmd
        - ${TOPDIR}/internal:${DOCKER_WORKDIR}/internal
        - ${TOPDIR}/pkg:${DOCKER_WORKDIR}/pkg
        - ${TOPDIR}/.habitat:/.habitat
        - /var/run/docker.sock:/var/run/docker.sock
    environment:
        - HABITAT_PATH=/.habitat
        - HABITAT_APP_PATH=${DEV_HABITAT_APP_PATH}
    ports:
      - 3000:3000
      - 3001:3001
      - 4000:4000
    image: habitat_node
    build: node.dev.Dockerfile
    env_file:
      - path: ../dev.env
        required: false
